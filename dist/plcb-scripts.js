"use strict";function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,i){for(var t=0;t<i.length;t++){var o=i[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,i,t){return i&&_defineProperties(e.prototype,i),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var __slide=function(e){return'\n<div class="inner">\n    '.concat(e.withCloseOnSlide?'<button class="plcb-leave" data-plcb="closeslide"><svg viewPort="0 0 12 12" version="1.1" xmlns="http://www.w3.org/2000/svg"> <line x1="1" y1="11" x2="11" y2="1" stroke-width="2"/> <line x1="1" y1="1" x2="11" y2="11"  stroke-width="2"/></svg></button>':"",'\n    <div class="plcb-slide-text">\n        <p><strong>Questo sito usa i cookies</strong></p>\n        <p>Questo sito usa cookies tecnici per offrirti una migliore esperienza di navigazione. Pu&ograve; inoltre utilizzare cookie di "terze parti" (impostati da un sito web diverso da quello attualmente visitato)\n            per le finalit&agrave; descritte nella nostra <a href="').concat(e.urlCookiePolicy,"\">cookie policy</a>.<br /><br />\n            Puoi liberamente prestare, rifiutare o revocare il tuo consenso alle varie tipologie di cookies accedendo al <b>pannello delle preferenze</b> cliccando su <i>'Preferenze'</i>.<br />\n            Puoi rifiutare all'uso dei cookies cliccando su <i>'Rifiuta'</i>.<br />\n            Puoi acconsentire all'uso dei cookies nella loro interezza cliccando su <i>'Accetta'</i>.<br />\n            <small>L'uso dei cookies ha la durata di ").concat(e.dayExpires," giorni.</small>\n        </p>\n        <p>\n            <i>Cliccando sulla 'X' di chiusura del banner, non acconsenti all'uso dei cookie diversi dai cookies tecnici. In questo modo l'esperienza di navigazione <strong>potrebbe</strong> risultare compromessa.</i><br />\n            <strong>E' possibile leggere la nostra <a href=\"").concat(e.urlCookiePolicy,'">Cookie/Privacy Policy</a> completa</strong>\n        </p>\n    </div>\n    <div class="plcb-slide-buttons">\n        <button type="button" class="plcb-btn" data-plcb="settings">Preferenze</button>\n        <button type="button" class="plcb-btn plcb-btn-no" data-plcb="refuse">Rifiuta</button>\n        <button type="button" class="plcb-btn plcb-btn-yes" data-plcb="accept">Accetta</button>\n    </div>\n</div>\n')},__popup=function(e){return'\n<div class="popup-window">\n      <button class="plcb-leave" data-plcb="close"><svg viewPort="0 0 12 12" version="1.1" xmlns="http://www.w3.org/2000/svg"> <line x1="1" y1="11" x2="11" y2="1" stroke-width="2"/> <line x1="1" y1="1" x2="11" y2="11"  stroke-width="2"/></svg></button>\n      <p><strong>Cookie settings</strong></p>\n      <p>Puoi esprimere le tue preferenze per il settaggio dei cookies: </p>\n      <ul>\n        <li>Selezionando la o le singole tipologie di cookies cui dare il permesso e cliccare su <i>\'Aggiorna\'</i></li>\n        <li>Cliccando su <i>\'Accetta\'</i> per l\'accettazione di tutti i cookies, anche i non-essenziali (non-tecnici)</li>\n        <li>Cliccando su <i>\'Rifiuta tutti\'</i> non consentirai il processamento dei cookie non-essenziali</li>\n      </ul>\n      <p data-plcb-if="id"><small>Il tuo ID di consenso: <span data-plcb-fill="id"></span></small></p>\n      <div class="plcb-cookie-sec">\n        <label>\n          <input type="checkbox" name="plcb-essential" checked disabled> Cookies Essenziali\n          <small>Questi cookie sono necessari per garantire le funzionalit&agrave; di base del sito web.</small>\n        </label>\n        <label>\n          <input type="checkbox" name="plcb-functionality"> Cookies Funzionali\n          <small>Rendono il sito pi&ugrave; facile da usare (eventualmente salvando impostazioni di configurazione dell\'utente) e pi&ugrave; interattivo (mappe, grafici, etc...).<br /><b>'.concat(e.infoCookieFunctional?e.infoCookieFunctional:"",'</b></small>\n        </label>\n        <label>\n          <input type="checkbox" name="plcb-analytics"> Cookies Analytics\n          <small>Vengono usati (anche se terzi) per migliorare la funzionalit&agrave; e la struttura del sito web, in base a come il sito viene utilizzato.<br /><b>').concat(e.infoCookieAnalytics?e.infoCookieAnalytics:"",'</b></small>\n        </label>\n        <label>\n          <input type="checkbox" name="plcb-advertising"> Cookies Pubblicitari\n          <small>Utilizzati per tracciare i visitatori attraverso i siti web consentendo di mostrare pubblicit&agrave; pertinenti e coinvolgenti.<br /><b>').concat(e.infoCookieAdvertising?e.infoCookieAdvertising:"",'</b></small>\n        </label>\n        <label>\n          <input type="checkbox" name="plcb-performance"> Cookies Performance\n          <small>Utilizzati specificamente per raccogliere dati sul caricamento della pagina o sui messaggi di errore dell\'utente nelle pagine web.<br /><b>').concat(e.infoCookiePerformance?e.infoCookiePerformance:"",'</b></small>\n        </label>\n      </div>\n      <small>\n        <strong>Ti invitiamo, comunque, a leggere <a href="').concat(e.urlCookiePolicy,'">l\'informativa estesa</a> nella quale &egrave; spiegato, inoltre, come poter disinstallare i cookies in base ai diversi Browser utilizzati.</strong>\n      </small>\n      <div class="plcb-submit">\n        <button type="button" class="plcb-btn plcb-btn-no" data-plcb="refuse">Rifiuta tutti</button>\n        <button type="button" class="plcb-btn" data-plcb="apply">Aggiorna</button>\n        <button type="button" class="plcb-btn plcb-btn-yes" data-plcb="accept">Accetta</button>\n      </div>\n</div>\n')},Plcb=function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:opts,t=i.dayExpires,o=void 0===t?365:t,n=i.withCloseOnSlide,s=void 0===n||n,a=i.urlCookiePolicy,c=void 0===a?"#":a,l=i.infoCookiePerformance,r=void 0===l?"":l,u=i.infoCookieAdvertising,d=void 0===u?"":u,h=i.infoCookieAnalytics,p=void 0===h?"":h,k=i.infoCookieFunctional,b=void 0===k?"":k;_classCallCheck(this,e),this.cookieConsentName="plcb-consent",this.cookiePerformanceName="plcb-performance",this.cookieFunctionalityName="plcb-functionality",this.cookieAdvertisingName="plcb-advertising",this.cookieAnalyticsName="plcb-analytics",this.options={dayExpires:o,withCloseOnSlide:s,urlCookiePolicy:c,infoCookiePerformance:r,infoCookieAdvertising:d,infoCookieAnalytics:p,infoCookieFunctional:b},this.templateSlide=this.options.templateSlide?this.options.templateSlide:__slide(this.options),this.templatePopup=this.options.templatePopup?this.options.templatePopup:__popup(this.options),this.essentialCallback=function(){},this.performanceCallback=function(){},this.functionalityCallback=function(){},this.advertisingCallback=function(){},this.analyticsCallback=function(){},this.logConsent=function(e){}}return _createClass(e,[{key:"init",value:function(){this.initDom(),this.getCookies(),void 0===this.cookieConsent?(this.showBar(),this.showBackground()):(this.runCallbacks(),this.hideBackground()),this.initListeners()}},{key:"initDom",value:function(){this.elBar=document.querySelector("#plcb-slide"),this.elPop=document.querySelector("#plcb-settings"),this.elBackground=document.querySelector(".plcb-container"),this.startTemplate(),this.elBtnCYes=document.querySelectorAll('*[data-plcb="accept"]'),this.elBtnCNo=document.querySelectorAll('*[data-plcb="refuse"]'),this.elBtnSettings=document.querySelectorAll('*[data-plcb="settings"]'),this.elBtnOpen=document.querySelectorAll('*[data-plcb="bar"]'),this.elBtnCloseSlide=document.querySelectorAll('*[data-plcb="closeslide"]'),this.elBtnClose=document.querySelectorAll('*[data-plcb="close"]'),this.elApply=document.querySelectorAll('*[data-plcb="apply"]'),this.elConsentId=document.querySelectorAll('*[data-plcb-fill="id"]'),this.elIfConsentId=document.querySelectorAll('*[data-plcb-if="id"]'),this.elInputPerformance=document.querySelector('input[name="'+this.cookiePerformanceName+'"]'),this.elInputFunctionality=document.querySelector('input[name="'+this.cookieFunctionalityName+'"]'),this.elInputAdvertising=document.querySelector('input[name="'+this.cookieAdvertisingName+'"]'),this.elInputAnalytic=document.querySelector('input[name="'+this.cookieAnalyticsName+'"]')}},{key:"startTemplate",value:function(){this.elBar&&(this.elBar.innerHTML=this.templateSlide),this.elPop&&(this.elPop.innerHTML=this.templatePopup)}},{key:"initListeners",value:function(){var e=this,i=this;this.elBtnCYes.forEach((function(e){e.addEventListener("click",(function(e){i.setAcceptAll(),i.processUserInput()}))})),this.elBtnCNo.forEach((function(e){e.addEventListener("click",(function(e){i.setRefuseAll(),i.processUserInput()}))})),this.elBtnSettings.forEach((function(e){e.addEventListener("click",(function(e){i.showBackground(),i.hideBar(),i.showPopup()}))})),this.elBtnOpen.forEach((function(e){e.addEventListener("click",(function(e){i.showBackground(),i.hidePopup(),i.showBar()}))})),this.elBtnClose.forEach((function(t){t.addEventListener("click",(function(t){i.hidePopup(),e.consentGiven()?(i.showBackground(),i.showBar()):i.hideBackground()}))})),this.elBtnCloseSlide.forEach((function(e){e.addEventListener("click",(function(e){i.setRefuseAll(),i.processUserInput(),i.hideBar()}))})),this.elApply.forEach((function(e){e.addEventListener("click",(function(e){i.hidePopup(),i.saveSettings(),i.processUserInput()}))}))}},{key:"setAcceptAll",value:function(){this.cookiePerformance=!0,this.cookieFunctionality=!0,this.cookieAdvertising=!0,this.cookieAnalytics=!0}},{key:"setRefuseAll",value:function(){this.cookiePerformance=!1,this.cookieFunctionality=!1,this.cookieAdvertising=!1,this.cookieAnalytics=!1}},{key:"processUserInput",value:function(){this.cookieConsent=this.renderConsentHash(),this.setCookies(),this.logConsent(this),this.hideBar(),this.hidePopup(),this.hideBackground(),this.runCallbacks()}},{key:"showBar",value:function(){this.elBar.classList.add("shown")}},{key:"showPopup",value:function(){this.loadSettings(),this.fillData(),this.elPop.classList.add("shown")}},{key:"hideBar",value:function(){this.elBar.classList.remove("shown")}},{key:"hidePopup",value:function(){this.elPop.classList.remove("shown")}},{key:"hideBackground",value:function(){this.elBackground.classList.add("hide")}},{key:"showBackground",value:function(){this.elBackground.classList.remove("hide")}},{key:"fillData",value:function(){var e=this;this.elConsentId.forEach((function(i){i.innerHTML=e.cookieConsent})),this.elIfConsentId.forEach((function(i){e.consentGiven()?i.style.display="none":i.style.display="block"}))}},{key:"consentGiven",value:function(){return void 0===this.cookieConsent}},{key:"getCookies",value:function(){this.cookieConsent=this.getCookie(this.cookieConsentName),this.cookiePerformance=this.getCookie(this.cookiePerformanceName),this.cookieFunctionality=this.getCookie(this.cookieFunctionalityName),this.cookieAdvertising=this.getCookie(this.cookieAdvertisingName),this.cookieAnalytics=this.getCookie(this.cookieAnalyticsName)}},{key:"getCookie",value:function(e){var i,t=e+"=";return decodeURIComponent(document.cookie).split("; ").forEach((function(e){0===e.indexOf(t)&&(i=e.substring(t.length))})),i}},{key:"setCookies",value:function(){var e=new Date;e.setTime(e.getTime()+24*this.options.dayExpires*60*60*1e3);var i="; expires="+e.toUTCString();this.setCookie(this.cookieConsentName,this.cookieConsent,i),this.setCookie(this.cookiePerformanceName,this.cookiePerformance,i),this.setCookie(this.cookieFunctionalityName,this.cookieFunctionality,i),this.setCookie(this.cookieAdvertisingName,this.cookieAdvertising,i),this.setCookie(this.cookieAnalyticsName,this.cookieAnalytics,i)}},{key:"setCookie",value:function(e,i,t){document.cookie=e+"="+i+t+"; path=/"}},{key:"renderConsentHash",value:function(){for(var e=navigator.userAgent,i=2,t=0;t<e.length;t++){i=(i<<5)-i+e.charCodeAt(t),i&=i}return(+new Date).toString()+"-"+Math.abs(i)+"-"+Math.round(999999999*Math.random()+1)}},{key:"runCallbacks",value:function(){this.essentialCallback(),"true"!==this.cookiePerformance&&!0!==this.cookiePerformance||this.performanceCallback(),"true"!==this.cookieFunctionality&&!0!==this.cookieFunctionality||this.functionalityCallback(),"true"!==this.cookieAdvertising&&!0!==this.cookieAdvertising||this.advertisingCallback(),"true"!==this.cookieAnalytics&&!0!==this.cookieAnalytics||this.analyticsCallback()}},{key:"loadSettings",value:function(){this.elInputPerformance.checked=1==this.cookiePerformance||"true"==this.cookiePerformance,this.elInputFunctionality.checked=1==this.cookieFunctionality||"true"==this.cookieFunctionality,this.elInputAdvertising.checked=1==this.cookieAdvertising||"true"==this.cookieAdvertising,this.elInputAnalytic.checked=1==this.cookieAnalytics||"true"==this.cookieAnalytics}},{key:"saveSettings",value:function(){this.cookiePerformance=this.elInputPerformance.checked,this.cookieFunctionality=this.elInputFunctionality.checked,this.cookieAdvertising=this.elInputAdvertising.checked,this.cookieAnalytics=this.elInputAnalytic.checked}}]),e}();