"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}var Plcb=function(){function e(){_classCallCheck(this,e),this.cookieConsentName="plcb-consent",this.cookiePerformanceName="plcb-performance",this.cookieFunctionalityName="plcb-functionality",this.cookieAdvertisingName="plcb-advertising",this.cookieAnalyticsName="plcb-analytics",this.essentialCallback=function(){},this.performanceCallback=function(){},this.functionalityCallback=function(){},this.advertisingCallback=function(){},this.analyticsCallback=function(){},this.logConsent=function(e){}}return _createClass(e,[{key:"init",value:function(){this.initDom(),this.getCookies(),void 0===this.cookieConsent?this.showBar():this.runCallbacks(),this.initListeners()}},{key:"initDom",value:function(){this.elBar=document.querySelector("#plcb-slide"),this.elPop=document.querySelector("#plcb-settings"),this.elBtnCYes=document.querySelectorAll('*[data-plcb="accept"]'),this.elBtnCNo=document.querySelectorAll('*[data-plcb="refuse"]'),this.elBtnSettings=document.querySelectorAll('*[data-plcb="settings"]'),this.elBtnOpen=document.querySelectorAll('*[data-plcb="bar"]'),this.elBtnClose=document.querySelectorAll('*[data-plcb="close"]'),this.elApply=document.querySelectorAll('*[data-plcb="apply"]'),this.elConsentId=document.querySelectorAll('*[data-plcb-fill="id"]'),this.elIfConsentId=document.querySelectorAll('*[data-plcb-if="id"]'),this.elInputPerformance=document.querySelector('input[name="'+this.cookiePerformanceName+'"]'),this.elInputFunctionality=document.querySelector('input[name="'+this.cookieFunctionalityName+'"]'),this.elInputAdvertising=document.querySelector('input[name="'+this.cookieAdvertisingName+'"]'),this.elInputAnalytic=document.querySelector('input[name="'+this.cookieAnalyticsName+'"]')}},{key:"initListeners",value:function(){var e=this,t=this;this.elBtnCYes.forEach((function(e){e.addEventListener("click",(function(e){t.setAcceptAll(),t.proccessUserInput()}))})),this.elBtnCNo.forEach((function(e){e.addEventListener("click",(function(e){t.setRefuseAll(),t.proccessUserInput()}))})),this.elBtnSettings.forEach((function(e){e.addEventListener("click",(function(e){t.hideBar(),t.showPopup()}))})),this.elBtnOpen.forEach((function(e){e.addEventListener("click",(function(e){t.hidePopup(),t.showBar()}))})),this.elBtnClose.forEach((function(i){i.addEventListener("click",(function(i){t.hidePopup(),e.consentGiven()&&t.showBar()}))})),this.elApply.forEach((function(e){e.addEventListener("click",(function(e){t.hidePopup(),t.saveSettings(),t.proccessUserInput()}))}))}},{key:"setAcceptAll",value:function(){this.cookiePerformance=!0,this.cookieFunctionality=!0,this.cookieAdvertising=!0,this.cookieAnalytics=!0}},{key:"setRefuseAll",value:function(){this.cookiePerformance=!1,this.cookieFunctionality=!1,this.cookieAdvertising=!1,this.cookieAnalytics=!1}},{key:"proccessUserInput",value:function(){this.cookieConsent=this.renderConsentHash(),this.setCookies(),this.logConsent(this),this.hideBar(),this.hidePopup(),this.runCallbacks()}},{key:"showBar",value:function(){this.elBar.classList.add("shown")}},{key:"showPopup",value:function(){this.loadSettings(),this.fillData(),this.elPop.classList.add("shown")}},{key:"hideBar",value:function(){this.elBar.classList.remove("shown")}},{key:"hidePopup",value:function(){this.elPop.classList.remove("shown")}},{key:"fillData",value:function(){var e=this;this.elConsentId.forEach((function(t){t.innerHTML=e.cookieConsent})),this.elIfConsentId.forEach((function(t){e.consentGiven()?t.style.display="none":t.style.display="block"}))}},{key:"consentGiven",value:function(){return void 0===this.cookieConsent}},{key:"getCookies",value:function(){this.cookieConsent=this.getCookie(this.cookieConsentName),this.cookiePerformance=this.getCookie(this.cookiePerformanceName),this.cookieFunctionality=this.getCookie(this.cookieFunctionalityName),this.cookieAdvertising=this.getCookie(this.cookieAdvertisingName),this.cookieAnalytics=this.getCookie(this.cookieAnalyticsName)}},{key:"getCookie",value:function(e){var t,i=e+"=";return decodeURIComponent(document.cookie).split("; ").forEach((function(e){0===e.indexOf(i)&&(t=e.substring(i.length))})),t}},{key:"setCookies",value:function(){var e=new Date;e.setTime(e.getTime()+15768e7);var t="; expires="+e.toUTCString();this.setCookie(this.cookieConsentName,this.cookieConsent,t),this.setCookie(this.cookiePerformanceName,this.cookiePerformance,t),this.setCookie(this.cookieFunctionalityName,this.cookieFunctionality,t),this.setCookie(this.cookieAdvertisingName,this.cookieAdvertising,t),this.setCookie(this.cookieAnalyticsName,this.cookieAnalytics,t)}},{key:"setCookie",value:function(e,t,i){document.cookie=e+"="+t+i+"; path=/"}},{key:"renderConsentHash",value:function(){for(var e=navigator.userAgent,t=2,i=0;i<e.length;i++){t=(t<<5)-t+e.charCodeAt(i),t&=t}return(+new Date).toString()+"-"+Math.abs(t)+"-"+Math.round(999999999*Math.random()+1)}},{key:"runCallbacks",value:function(){this.essentialCallback(),"true"!==this.cookiePerformance&&!0!==this.cookiePerformance||this.performanceCallback(),"true"!==this.cookieFunctionality&&!0!==this.cookieFunctionality||this.functionalityCallback(),"true"!==this.cookieAdvertising&&!0!==this.cookieAdvertising||this.advertisingCallback(),"true"!==this.cookieAnalytics&&!0!==this.cookieAnalytics||this.analyticsCallback()}},{key:"loadSettings",value:function(){this.elInputPerformance.checked=1==this.cookiePerformance||"true"==this.cookiePerformance,this.elInputFunctionality.checked=1==this.cookieFunctionality||"true"==this.cookieFunctionality,this.elInputAdvertising.checked=1==this.cookieAdvertising||"true"==this.cookieAdvertising,this.elInputAnalytic.checked=1==this.cookieAnalytics||"true"==this.cookieAnalytics}},{key:"saveSettings",value:function(){this.cookiePerformance=this.elInputPerformance.checked,this.cookieFunctionality=this.elInputFunctionality.checked,this.cookieAdvertising=this.elInputAdvertising.checked,this.cookieAnalytics=this.elInputAnalytic.checked}}]),e}();